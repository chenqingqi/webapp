/*模块化框架 - starry*/
function Plugin(){var a=[];this.module=function(b,c){a.push({name:b,func:c})};this.reg=function(b){if(arguments.length==1){for(var c=0;c<a.length;c++){if(b==a[c].name){if(typeof a[c].func=="function"){a[c].func=new a[c].func();return a[c].func}else{return a[c].func}}}}else{for(var d=0;d<arguments.length;d++){for(var c=0;c<a.length;c++){if(arguments[d]==a[c].name){if(typeof a[c].func=="function"){a[c].func=new a[c].func()}}}}}};this.get=function(b){for(var c=0;c<a.length;c++){if(b==a[c].name){if(typeof a[c].func=="function"){return a[c].func}else{throw b+"已在全局注册！"}}}}}window.plugin=new Plugin();window.module=plugin.module;window.reg=plugin.reg;window.get=plugin.get;function ClassLoader(){var b=document.getElementsByTagName("head").item(0);var a=document.createElement("script");a.src=document.getElementsByTagName("script")[0].attributes["main"].value+".js";b.appendChild(a);a.onload=function(){b.removeChild(a)};this.load=function(g,c){var e=0;var f=[];for(var d in g){f.push(g[d])}function h(){var j=document.getElementsByTagName("head").item(0);var i=document.createElement("script");j.appendChild(i);i.src=f[e]+".js";i.onload=function(){e+=1;j.removeChild(i);if(e==f.length){c()}else{h()}}}h()}}window["config"]=new ClassLoader().load;function Notifier(){var a=[];this.sendEvent=function(c,d){for(var b=0;b<a.length;b++){if(a[b].type==c){a[b].back({type:c,data:d})}}};this.listenEvent=function(c,b){a.push({type:c,back:b})};this.seek=function(c){for(var b=0;b<a.length;b++){if(a[b].type==c){return true}}return false}}window.notifier=new Notifier();window.sendEvent=notifier.sendEvent;window.listenEvent=notifier.listenEvent;
